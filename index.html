<!-- Sync Successful -->

<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OpenCounsel — Private, Local AI Legal Assistant</title>
  <meta name="description" content="OpenCounsel: a private, local AI legal assistant with RAG, document search, and case analysis. Download for macOS, Windows, and Linux." />
  <link rel="icon" type="image/png" href="favicon.png">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

  <!-- Icons + Tailwind -->
  <script src="https://unpkg.com/@phosphor-icons/web"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Inter','ui-sans-serif','system-ui'] },
          colors: {
            oc: { ink:'#0A0D10', soft:'#F5F7F9', line:'#E7EDF2', accent:'#5B8CFF', lilac:'#E7E7FF' }
          },
          boxShadow: {
            card:'0 6px 30px rgba(16,24,40,0.08)',
            glow:'0 0 0 1px rgba(255,255,255,.06), 0 10px 30px rgba(16,24,40,.18)'
          }
        }
      }
    }
  </script>

  <style>
    :root {
      --pad-mobile-x: 24px;
      --pad-desktop-x: 32px;
      --hamburger-inset: 13px;

      /* Motion + scroll blur */
      --scroll-blur-start: 16px;
      --scroll-blur-end: 0px;
      --scroll-blur-duration: 1500ms;
      --scroll-blur-ease: cubic-bezier(.2,.8,.2,1);
      --scroll-blur-opacity-start: .65;
      --scroll-blur-opacity-end: 1;
      --scroll-blur-translate: 8px;

      /* Palette hooks */
      --line:#E7EDF2;
      --brand-angle:135deg;
      --brand-1:#0B1B2B;
      --brand-2:#0E6F5C;
      --brand-3:#00CFFF;
      --lilac:#E7E7FF;

      --site-bg:#fff;
      --hdr:56px; /* updated at runtime */
    }

    html, body { background: var(--site-bg); max-width: 100%; overflow-x: clip !important; }
    @supports not (overflow-x: clip) { html, body { overflow-x: hidden !important; } }
    .section-clip { position: relative; overflow-x: clip; }
    .oc-container { padding-left: var(--pad-mobile-x); padding-right: var(--pad-mobile-x); }
    @media (min-width: 1024px) { .oc-container { padding-left: var(--pad-desktop-x); padding-right: var(--pad-desktop-x); } }
    ::selection{background:#5B8CFF;color:#fff}

    @media (prefers-reduced-motion: no-preference) {
      .reveal { opacity:0; transform: translateY(18px) scale(.98); transition: opacity .6s ease, transform .6s ease; }
      .reveal.in { opacity:1; transform: translateY(0) scale(1); }
      .tilt:hover{ transform: translateY(-2px) scale(1.01); }
      .tilt{ transition: transform .25s ease; }
    }

    @keyframes logoIntro { from { transform: translateY(6px) scale(.92); opacity:0 } to { transform: translateY(0) scale(1); opacity:1 } }
    @keyframes gradientShift { 0%{background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%} }

    #hamburgerBtn .hamburger { --from:#00CFFFcc; --via:#0E6F5Ccc; --to:#0B1B2Bcc; --angle:135deg; --speed:16s; }
    :root{ --from:#0B1B2Bcc; --via:#0E6F5Ccc; --to:#00CFFFcc; --speed:16s; --angle:135deg; --grad-from:#0B1B2Bcc; --grad-via:#0E6F5Ccc; --grad-to:#00CFFFcc; --logo-width:64px; --logo-height:64px; }
    #home { --from:#0B1B2Bcc; --via:#0E6F5Ccc; --to:#00CFFFcc; --speed:16s; --angle:135deg; }
    #edge { --from:#0B1B2Bcc; --via:#0E6F5Ccc; --to:#0B1B2Bcc; --speed:16s; --angle:135deg; }
    #features { --from:#0B1B2Bcc; --via:#0E6F5Ccc; --to:#0B1B2Bcc; --speed:16s; --angle:135deg; }

    .g-grad, .grad-anim{ background: linear-gradient(var(--angle,135deg), var(--from,#0a1f44cc), var(--via,#0b3d3dcc), var(--to,#064420cc)); background-size:300% 300%; animation:gradientShift var(--speed,16s) ease-in-out infinite; will-change:background-position; }
    .animated-gradient { background-size:300% 300%; animation:gradientShift 16s ease-in-out infinite; will-change:background-position; }
    .logo-anim{ display:inline-block; width:var(--logo-width); height:var(--logo-height); background:linear-gradient(135deg, var(--grad-from), var(--grad-via), var(--grad-to)); background-size:300% 300%; animation:logoIntro 800ms ease-out forwards, gradientShift 16s ease-in-out infinite; -webkit-mask:url('logo.svg') no-repeat center/contain; mask:url('logo.svg') no-repeat center/contain; }
    .grad-text{ background:linear-gradient(var(--angle,135deg), var(--from,#0a1f44cc), var(--via,#0b3d3dcc), var(--to,#064420cc)); background-size:300% 300%; animation:gradientShift var(--speed,16s) ease-in-out infinite; -webkit-background-clip:text; background-clip:text; -webkit-text-fill-color:transparent; color:transparent; }

    .mobile-menu { backdrop-filter: blur(8px); }
    .hamburger { width: 32px; height: 28px; display: inline-flex; flex-direction: column; justify-content: center; gap: 6px; }
    .hamburger span { height: 3px; width: 100%; border-radius: 9999px; background: linear-gradient(var(--angle,135deg), var(--from,#0a1f44), var(--via,#0b3d3d), var(--to,#064420)); background-size:300% 300%; animation:gradientShift var(--speed,16s) ease-in-out infinite; transition: transform .4s ease, opacity .2s ease; }
    #hamburgerBtn.is-active .hamburger span:nth-child(1){ transform: translateY(9px) rotate(45deg); }
    #hamburgerBtn.is-active .hamburger span:nth-child(2){ opacity: 0; }
    #hamburgerBtn.is-active .hamburger span:nth-child(3){ transform: translateY(-9px) rotate(-45deg); }

    .rows-equal { grid-auto-rows: 1fr; }
    .grid-stretch > * { height: 100%; }
    .card-glass { display:flex; flex-direction:column; height:100%; }

    .page-blur{ position:fixed; inset:0; backdrop-filter:blur(28px); -webkit-backdrop-filter:blur(28px); background:rgba(255,255,255,.28); z-index:9999; pointer-events:none; transition: backdrop-filter 2s ease, background-color 2s ease, opacity 2s ease; }
    .page-blur.hide{ backdrop-filter:blur(0); -webkit-backdrop-filter:blur(0); background:transparent; opacity:0; }

    #mobileMenu { position:fixed; inset:0; z-index:60; display:none; pointer-events:none; }
    #mobileMenu .menu-scrim{ position:absolute; inset:0; background: rgba(255,255,255,0.92); -webkit-backdrop-filter: blur(12px); backdrop-filter: blur(12px); opacity:0; transition: opacity 2s ease, backdrop-filter 2s ease, -webkit-backdrop-filter 2s ease; }
    #mobileMenu .menu-panel{ position:absolute; top:0; left:0; height:100%; width:min(88vw,420px); background:#fff; border-right:1px solid rgba(0,0,0,.06); box-shadow:0 24px 60px rgba(0,0,0,.12); transform:translateX(-100%); opacity:.98; filter:blur(12px); transition: transform .5s cubic-bezier(.22,.9,.22,1), filter 1s ease .1s; display:flex; flex-direction:column; padding:18px 20px; }
    #mobileMenu.active { display:block; pointer-events:auto; }
    #mobileMenu.active .menu-scrim{ opacity:1; -webkit-backdrop-filter:blur(0px); backdrop-filter:blur(0px); }
    #mobileMenu.active .menu-panel{ transform:translateX(0); filter:blur(0); }

    .drawer-head{ display:flex; align-items:center; justify-content:space-between; padding-bottom:6px; }
    .drawer-title{ font-weight:700; letter-spacing:-.01em; background: linear-gradient(135deg, var(--grad-from), var(--grad-via), var(--grad-to)); background-size:300% 300%; animation:gradientShift 16s ease-in-out infinite; -webkit-background-clip:text; background-clip:text; -webkit-text-fill-color:transparent; color:transparent; font-size:20px; }
    .drawer-close{ display:inline-flex; align-items:center; justify-content:center; width:40px; height:40px; border-radius:12px; border:1px solid rgba(0,0,0,.06); background:rgba(255,255,255,.8); transition: background .2s ease, transform .2s ease; }
    .drawer-close:hover{ background:#fff; transform:translateY(-1px); }

    .drawer-nav a:not(.drawer-cta){ display:block; padding:14px 2px; font-weight:700; font-size:clamp(18px,4.4vw,20px); line-height:1.2; background: linear-gradient(135deg, var(--grad-from), var(--grad-via), var(--grad-to)); background-size:300% 300%; animation:gradientShift 16s ease-in-out infinite; -webkit-background-clip:text; background-clip:text; -webkit-text-fill-color:transparent; color:transparent; transition: transform .18s ease, opacity .18s ease; }
    .drawer-nav a:hover{ transform:translateY(-1px); opacity:.95; }
    .drawer-sep{ height:1px; background:linear-gradient(90deg, transparent, rgba(0,0,0,.08), transparent); margin:8px 0 6px; }
    .drawer-cta{ display:inline-flex!important; align-items:center; justify-content:center; width:100%; position:relative; color:#fff!important; -webkit-text-fill-color:#fff!important; }
    .drawer-cta > span{ z-index:0!important; }

    /* Scroll-fade utility */
    .scroll-fade { isolation:isolate; }
    .scroll-fade > * { filter: blur(var(--scroll-blur-start)); opacity: var(--scroll-blur-opacity-start); transform: translateY(var(--scroll-blur-translate)); transition: filter var(--scroll-blur-duration) var(--scroll-blur-ease), opacity var(--scroll-blur-duration) var(--scroll-blur-ease), transform var(--scroll-blur-duration) var(--scroll-blur-ease); will-change: filter, opacity, transform; backface-visibility:hidden; transform:translateZ(0); }
    .scroll-fade.in-view > * { filter:blur(var(--scroll-blur-end)); opacity:var(--scroll-blur-opacity-end); transform:translateY(0); }

    /* Brand bits */
    .brand-gradient{ background-image:linear-gradient(var(--brand-angle),var(--brand-1),var(--brand-2),var(--brand-3)); background-size:200% 200%; }
    @keyframes breathe{0%{background-position:0% 50%;filter:saturate(.95)}50%{background-position:100% 50%;filter:saturate(1.05)}100%{background-position:0% 50%;filter:saturate(.95)}}
    .breathing{animation:breathe 6s ease-in-out infinite}
    .think-stream{ color:transparent; background-image:linear-gradient(var(--brand-angle),#00CFFF,#0E6F5C,#00CFFF); background-size:200% 200%; -webkit-background-clip:text; background-clip:text; animation:breathe 4.5s ease-in-out infinite; filter:drop-shadow(0 0 .3rem rgba(0,207,255,.3)); white-space:pre-wrap; line-height:1.6 }
    @keyframes fadeAway{to{opacity:0;transform:translateY(-4px);filter:blur(2px)}}
    .fade-away{animation:fadeAway .38s ease forwards}

    /* ===== Chat: full-screen-like, perfectly centered ===== */
    .chat-wrap { width:min(1024px,100%); margin:0 auto; position: relative; }
    #chat-demo{
      background: var(--site-bg);
      height: calc(100dvh - var(--hdr));
      min-height: calc(100dvh - var(--hdr));
      display: grid;
      align-items: center;
      justify-items: center;
      padding: 0 var(--pad-mobile-x);
      overflow-anchor: none;   /* prevent jumps as messages stream */
      will-change: transform;
    }
    @media (min-width: 1024px){ #chat-demo{ padding: 0 var(--pad-desktop-x); } }

    /* Chat viewport acts like a video canvas: programmatic scroll only */
    .chat-viewport{
      height: calc(100dvh - var(--hdr));
      width: min(980px, 92vw);
      overflow-y: auto;              /* needed for programmatic auto-scroll */
      overscroll-behavior: contain;
      scroll-behavior: smooth;
      background: transparent;
      padding: 18px 18px 220px 18px; /* extra bottom so next bubble peeks */
      -ms-overflow-style: none; scrollbar-width: none;
      overflow-anchor: none;
      pointer-events: none;          /* user cannot scroll the chat itself */
    }
    .chat-viewport::-webkit-scrollbar{ display:none; }

    /* When the section is snapped, add generous top padding before first bubble */
    #chat-demo.is-snapped .chat-viewport{
      padding-top: clamp(8vh, 10vh, 12vh);
    }

    .chat-stream { display:flex; flex-direction:column; gap:10px; }
    .msg-row { display:flex; width:100%; }
    .msg-assistant { justify-content:flex-start; padding-left:56px; }
    .msg-user { justify-content:flex-end; padding-right:56px; }

    .bubble {
      max-width:85%; border-radius:16px; padding:12px 16px;
      font-size:15px; line-height:1.6; box-shadow:0 2px 6px rgba(10,13,16,.04), 0 12px 24px rgba(10,13,16,.06);
      overflow-wrap:anywhere; word-break:break-word; hyphens:auto; background-clip:padding-box;
      background:#fff;
    }
    .bubble * { overflow-wrap:anywhere; word-break:break-word; hyphens:auto; }
    .bubble p { margin:.35rem 0; }
    .bubble ul { list-style:disc; padding-left:1.15rem; margin:.3rem 0; }
    .bubble li { margin:.18rem 0; }
    .bubble strong { font-weight:700; }
    .bubble em { font-style:italic; }

    .bubble-user { background:#fff; border:1px solid var(--line); }
    .bubble-bot { background: color-mix(in srgb, var(--lilac) 35%, white); border:1px solid var(--line); }
    .bubble .ai-final{ color:#0A0D10; white-space:normal; }

    /* ===== Document Preview (kept for future use; not used in this capped demo) ===== */
    .doc-page{
      background:#fff; border:1px solid rgba(10,13,16,.06); box-shadow:0 10px 28px rgba(10,13,16,.10);
      border-radius:14px; padding:28px 28px 32px 28px; aspect-ratio:8.5/11; overflow:hidden;
      width:min(620px,85vw); max-width:100%;
    }
    .doc-h1{ font-size:20px; font-weight:700; letter-spacing:.02em; text-transform:uppercase; text-align:center; }
    .doc-sub{ font-size:12px; text-align:center; color:#666; margin-top:2px; }
    .doc-sec{ font-size:12px; font-weight:600; letter-spacing:.02em; text-transform:uppercase; color:#0A0D10; margin-top:16px; }
    .doc-p{ font-size:13px; line-height:1.5; color:#0A0D10; margin-top:6px; }
    .doc-small{ font-size:12px; color:#333; }
    .doc-rule{ height:1px; background:linear-gradient(90deg, transparent, rgba(0,0,0,.12), transparent); margin:12px 0; }
    .doc-bullets{ padding-left:18px; margin-top:4px; }
    .doc-bullets li{ font-size:13px; line-height:1.5; margin:4px 0; }
    .doc-brand-band{ height:8px; border-radius:10px; }
    .doc-fade{ opacity:0; transform: translateY(4px); transition: opacity .25s ease, transform .25s ease; }
    .doc-fade.in{ opacity:1; transform: translateY(0); }
  </style>
</head>

<body class="bg-white text-oc-ink font-sans antialiased">
  <!-- FULL-PAGE BLUR OVERLAY -->
  <div id="pageBlur" class="page-blur" aria-hidden="true"></div>

  <!-- HEADER -->
  <header class="sticky top-0 z-50 bg-white">
    <div class="relative mx-auto max-w-[1200px] oc-container h-14 flex items-center justify-between">
      <div class="flex items-center gap-3"><span class="logo-anim" role="img" aria-label="OpenCounsel"></span></div>
      <nav class="hidden md:flex absolute left-1/2 -translate-x-1/2 items-center gap-8 text-sm">
        <a class="nav-link grad-anim bg-clip-text text-transparent font-medium" href="#features">Features</a>
        <a class="nav-link grad-anim bg-clip-text text-transparent font-medium" href="#edge">Why it wins</a>
        <a class="nav-link grad-anim bg-clip-text text-transparent font-medium" href="#plans">Plans</a>
        <a class="nav-link grad-anim bg-clip-text text-transparent font-medium" href="#screens">Screens</a>
        <a class="nav-link grad-anim bg-clip-text text-transparent font-medium" href="#faq">FAQ</a>
      </nav>
      <div class="flex items-center gap-2">
        <button id="hamburgerBtn" class="md:hidden rounded-xl tap-boost bg-transparent focus:outline-none focus:ring-2 focus:ring-oc-accent" aria-label="Open menu" aria-expanded="false" aria-controls="mobileMenu">
          <span class="hamburger" aria-hidden="true"><span></span><span></span><span></span></span>
        </button>
      </div>
    </div>

    <!-- MOBILE MENU -->
    <div id="mobileMenu" aria-hidden="true">
      <div class="menu-scrim"></div>
      <aside class="menu-panel">
        <div class="drawer-head">
          <span class="drawer-title">OpenCounsel</span>
          <button id="closeMenuBtn" class="drawer-close" aria-label="Close menu">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M6 6l12 12M18 6L6 18" stroke="#0A0D10" stroke-width="2" stroke-linecap="round"/></svg>
          </button>
        </div>

        <nav class="drawer-nav mt-2">
          <a href="#features">Features</a>
          <a href="#edge">Why it wins</a>
          <a href="#plans">Plans</a>
          <a href="#screens">Screens</a>
          <a href="#faq">FAQ</a>
          <div class="drawer-sep"></div>
          <a href="#download" class="drawer-cta grad-anim rounded-2xl px-6 py-3 font-semibold text-white" style="--from:var(--grad-from); --via:var(--grad-via); --to:var(--grad-to); --speed:16s; --angle:135deg;">
            <i class="ph ph-download text-xl"></i><span>Download</span>
          </a>
        </nav>
      </aside>
    </div>
  </header>

  <!-- HERO -->
  <section id="home" class="mx-auto max-w-[1200px] oc-container mt-0 reveal" style="overflow-anchor:auto;">
    <div class="g-grad grad-anim rounded-2xl overflow-hidden border border-oc-line box-border min-h-[calc(100svh-56px-var(--pad-mobile-x))] lg:min-h-[calc(100svh-56px-var(--pad-desktop-x))] flex items-center justify-center text-center px-[var(--pad-mobile-x)] lg:px-[var(--pad-desktop-x)]" style="min-height: calc(100vh - 56px - var(--pad-mobile-x));">
      <div class="flex flex-col items-center max-w-2xl">
        <span class="font-semibold text-white text-5xl md:text-7xl leading-tight">OpenCounsel</span>
        <p class="mt-4 text-lg md:text-xl text-white/90 leading-relaxed">AI for law. Designed for you.</p>
        <p class="mt-2 text-lg md:text-xl text-white/80 leading-relaxed">Local, private, and built for legal research.</p>
        <div class="mt-8 flex justify-center">
          <a href="#download" class="relative inline-flex items-center gap-2 rounded-2xl px-6 py-3 text-base md:text-lg font-semibold text-white focus:outline-none focus-visible:ring-4 focus-visible:ring-white/60 shadow-xl shadow-black/20 hover:shadow-2xl hover:shadow-black/30 transition-all duration-300 ease-out hover:-translate-y-[2px] active:translate-y-0 grad-anim" style="--from:#0E6F5Ccc; --via:#178D74cc; --to:#A0E4D4cc; --speed:16s; --angle:135deg;">
            <span class="pointer-events-none absolute inset-0 -z-10 rounded-2xl blur-xl opacity-70" style="background: radial-gradient(60% 60% at 50% 50%, rgba(0,207,255,.35), rgba(0,0,0,0));"></span>
            <i class="ph ph-download text-xl"></i> Download
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Secure. Local. Yours. -->
  <section class="mx-auto max-w-[1200px] oc-container reveal flex items-center justify-center text-center" style="padding-top:0;padding-bottom:0">
    <div class="w-full min-h-[34vh] md:min-h-[42vh] flex items-center justify-center">
      <div>
        <p class="text-2xl md:text-4xl font-semibold tracking-tight text-oc-ink">Secure. Local. Yours.</p>
        <span class="mt-2 block text-xs md:text-sm uppercase tracking-widest grad-text" style="--from:#0B1B2Bcc; --via:#0E6F5Ccc; --to:#00CFFFcc; --speed:16s; --angle:90deg;">For Everyone</span>
      </div>
    </div>
  </section>

  <!-- ===== LIVE CHAT DEMO ===== -->
  <section id="chat-demo" class="oc-container reveal" style="background: var(--site-bg);">
    <div class="chat-wrap">
      <!-- Video-like chat viewport (no user scroll) -->
      <div id="chatViewport" class="chat-viewport">
        <div id="demoMessages" class="chat-stream"></div>
      </div>
    </div>

    <!-- Templates -->
    <template id="demoTplUser">
      <div class="msg-row msg-user"><div class="bubble bubble-user"></div></div>
    </template>
    <template id="demoTplBot">
      <div class="msg-row msg-assistant">
        <div class="bubble bubble-bot">
          <div class="ai-think think-stream">Thinking</div>
          <div class="ai-final hidden"></div>
        </div>
      </div>
    </template>
  </section>

  <!-- EDGE / WHY IT WINS -->
  <section id="edge" class="mx-auto max-w-[1200px] oc-container reveal -mt-4 md:-mt-6" style="padding-top:0">
    <div class="mt-6 grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 rows-equal grid-stretch">
      <article class="scroll-fade group relative overflow-hidden rounded-3xl border border-white/20 g-grad grad-anim p-6 backdrop-blur-md hover:shadow-card tilt transition-transform card-glass">
        <div class="absolute inset-0 ring-1 ring-white/10 rounded-3xl pointer-events-none"></div>
        <div class="flex items-start gap-4">
          <div class="h-11 w-11 shrink-0 rounded-2xl bg-white/15 border border-white/25 flex items-center justify-center"><i class="ph ph-lock text-white text-[20px]"></i></div>
          <div><h3 class="font-semibold text-white tracking-tight">Private by Design</h3><p class="mt-2 text-sm leading-relaxed text-white/80">Models, search, and data stay on your device. Your work never leaves your hands.</p></div>
        </div>
        <div class="mt-auto"></div>
      </article>

      <article class="scroll-fade group relative overflow-hidden rounded-3xl border border-white/20 g-grad grad-anim p-6 backdrop-blur-md hover:shadow-card tilt transition-transform card-glass">
        <div class="absolute inset-0 ring-1 ring-white/10 rounded-3xl pointer-events-none"></div>
        <div class="flex items-start gap-4">
          <div class="h-11 w-11 shrink-0 rounded-2xl bg-white/15 border border-white/25 flex items-center justify-center"><i class="ph-light ph-open-ai-logo text-white text-[20px]"></i></div>
          <div><h3 class="font-semibold text-white tracking-tight">Built on GPT-5</h3><p class="mt-2 text-sm leading-relaxed text-white/80">Industry-leading intelligence, fine-tuned with deep legal expertise..</p></div>
        </div>
        <div class="mt-auto"></div>
      </article>

      <article class="scroll-fade group relative overflow-hidden rounded-3xl border border-white/20 g-grad grad-anim p-6 backdrop-blur-md hover:shadow-card tilt transition-transform card-glass">
        <div class="flex items-start gap-4">
          <div class="h-11 w-11 shrink-0 rounded-2xl bg-white/15 border border-white/25 flex items-center justify-center"><i class="ph ph-plug-charging text-white text-[20px]"></i></div>
          <div><h3 class="font-semibold text-white tracking-tight">Legal Knowledge Base</h3><p class="mt-2 text-sm leading-relaxed text-white/80">Trusted by government. Curated by leading counsel. Built for absolute clarity.</p></div>
        </div>
        <div class="mt-auto"></div>
      </article>
    </div>
  </section>

  <!-- COUNSEL FOR EVERYONE -->
  <section class="section-clip relative mx-auto max-w-[1200px] px-6 md:px-8 mt-24 pb-0 bg-white">
    <div aria-hidden="true" class="pointer-events-none absolute inset-0 -z-10">
      <div class="absolute left-1/2 top-0 h-72 w-[38rem] -translate-x-1/2 rounded-full blur-3xl" style="background: radial-gradient(60% 60% at 50% 40%, rgba(99,102,241,.25), rgba(99,102,241,0) 70%);"></div>
      <div class="absolute right-[-10%] bottom-[-10%] h-80 w-80 rounded-full blur-2xl" style="background: radial-gradient(55% 55% at 50% 50%, rgba(16,185,129,.18), rgba(16,185,129,0) 70%);"></div>
      <div class="absolute left-[-8%] bottom-[-6%] h-72 w-72 rounded-full blur-2xl" style="background: radial-gradient(55% 55% at 50% 50%, rgba(244,114,182,.18), rgba(244,114,182,0) 70%);"></div>
    </div>
    <div class="absolute inset-0 z-0 bg-white"></div>

    <div class="mission-wrap relative z-10 mx-auto max-w-[900px] rounded-3xl border border-black/5 bg-white/70 p-8 md:p-12 shadow-[0_10px_30px_rgba(0,0,0,0.06)] backdrop-blur">
      <div class="mx-auto w-fit rounded-full border border-black/10 bg-white/60 px-3 py-1 text-[11px] font-medium uppercase tracking-wide text-neutral-600">Mission</div>
      <h2 class="mt-4 text-center text-3xl md:text-4xl font-semibold tracking-tight text-neutral-900">Counsel for Everyone</h2>
      <p class="mx-auto mt-4 max-w-[650px] text-center text-lg leading-relaxed text-neutral-700">OpenCounsel makes legal intelligence as accessible as the internet itself. No barriers. No gatekeepers. Just powerful, private counsel — for anyone, anywhere.</p>
      <div class="mx-auto mt-8 h-px w-20 bg-gradient-to-r from-transparent via-neutral-300 to-transparent"></div>

      <div class="mt-8 grid grid-cols-1 gap-4 sm:grid-cols-3 rows-equal grid-stretch">
        <div class="rounded-2xl border border-neutral-200 bg-white p-5 flex flex-col">
          <div class="flex items-center gap-3">
            <svg class="h-6 w-6 text-neutral-900" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 3v3m0 0l6 3-6 3-6-3 6-3Zm0 6v9m-5 0h10" stroke-linecap="round" stroke-linejoin="round"/></svg>
            <p class="font-semibold text-neutral-900">Accessible</p>
          </div>
          <p class="mt-2 text-sm text-neutral-600">Powerful legal AI, designed for everyone.</p>
          <div class="mt-auto"></div>
        </div>
        <div class="rounded-2xl border border-neutral-200 bg-white p-5 flex flex-col">
          <div class="flex items-center gap-3">
            <svg class="h-6 w-6 text-neutral-900" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 3l7 4v5c0 4.5-3.1 8.6-7 9-3.9-.4-7-4.5-7-9V7l7-4z" stroke-linecap="round" stroke-linejoin="round"/></svg>
            <p class="font-semibold text-neutral-900">Private</p>
          </div>
          <p class="mt-2 text-sm text-neutral-600">Runs locally. Your data never leaves your device.</p>
          <div class="mt-auto"></div>
        </div>
        <div class="rounded-2xl border border-neutral-200 bg-white p-5 flex flex-col">
          <div class="flex items-center gap-3">
            <svg class="h-6 w-6 text-neutral-900" viewBox="0 0 24 24"  fill="none" stroke="currentColor" stroke-width="1.5"><path d="M9 12l2 2 4-4M12 22C6.5 22 2 17.5 2 12S6.5 2 12 2s10 4.5 10 10-4.5 10-10 10z" stroke-linecap="round" stroke-linejoin="round"/></svg>
            <p class="font-semibold text-neutral-900">Verified</p>
          </div>
          <p class="mt-2 text-sm text-neutral-600">Answers backed by case law and precedent.</p>
          <div class="mt-auto"></div>
        </div>
      </div>

      <div class="mt-10 flex items-center justify-center gap-3">
        <a href="#download" class="inline-flex items-center rounded-2xl bg-neutral-900 px-5 py-3 text-sm font-medium text-white hover:opacity-90">Get OpenCounsel</a>
        <a href="#learn-more" class="inline-flex items-center rounded-2xl border border-neutral-300 bg-white px-5 py-3 text-sm font-medium text-neutral-900 hover:bg-neutral-50">Learn more</a>
      </div>
    </div>
  </section>

  <!-- Secure Local Yours -->
  <section class="mx-auto max-w-[1200px] oc-container reveal flex items-center justify-center text-center" style="padding-top:0;padding-bottom:0">
    <div class="w-full min-h-[34vh] md:min-h-[42vh] flex items-center justify-center">
      <div>
        <p class="text-2xl md:text-4xl font-semibold tracking-tight text-oc-ink">Tomorrow’s Counsel.</p>
        <span class="mt-2 block text-xs md:text-sm uppercase tracking-widest grad-text" style="--from:#0B1B2Bcc; --via:#0E6F5Ccc; --to:#00CFFFcc; --speed:16s; --angle:90deg;">Today</span>
      </div>
    </div>
  </section>

  <!-- FEATURES -->
  <section id="features" class="mx-auto max-w-[1200px] oc-container reveal pt-0 mb-10 md:mb-10" style="padding-top:0px">
    <div class="grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 rows-equal grid-stretch">
      <article class="scroll-fade group relative overflow-hidden rounded-3xl border border-white/20 g-grad grad-anim p-6 backdrop-blur-md hover:shadow-card tilt transition-transform card-glass">
        <div class="absolute inset-0 ring-1 ring-white/10 rounded-3xl pointer-events-none"></div>
        <div class="flex items-start gap-4"><div class="h-11 w-11 shrink-0 rounded-2xl bg-white/15 border border-white/25 flex items-center justify-center"><i class="ph ph-shield-check text-white text-[20px]"></i></div><div><h3 class="font-semibold text-white tracking-tight">Verifiable Outputs</h3><p class="mt-2 text-sm leading-relaxed text-white/80">Every answer, backed by sources. Every step, documented.</p></div></div>
        <div class="mt-auto"></div>
      </article>
      <article class="scroll-fade group relative overflow-hidden rounded-3xl border border-white/20 g-grad grad-anim p-6 backdrop-blur-md hover:shadow-card tilt transition-transform card-glass">
        <div class="absolute inset-0 ring-1 ring-white/10 rounded-3xl pointer-events-none"></div>
        <div class="flex items-start gap-4"><div class="h-11 w-11 shrink-0 rounded-2xl bg-white/15 border border-white/25 flex items-center justify-center"><i class="ph ph-plug-charging text-white text-[20px]"></i></div><div><h3 class="font-semibold text-white tracking-tight">Custom Databases</h3><p class="mt-2 text-sm leading-relaxed text-white/80">Curated case law, contracts, filings, and legal statistics — all in one place.</p></div></div>
        <div class="mt-auto"></div>
      </article>
      <article class="scroll-fade group relative overflow-hidden rounded-3xl border border-white/20 g-grad grad-anim p-6 backdrop-blur-md hover:shadow-card tilt transition-transform card-glass">
        <div class="flex items-start gap-4"><div class="h-11 w-11 shrink-0 rounded-2xl bg-white/15 border border-white/25 flex items-center justify-center"><i class="ph ph-database text-white text-[20px]"></i></div><div><h3 class="font-semibold text-white tracking-tight">Your Local Library</h3><p class="mt-2 text-sm leading-relaxed text-white/80">Build your own on-disk databases. Drag-and-drop files for instant semantic search.</p></div></div>
        <div class="mt-auto"></div>
      </article>
    </div>
  </section>

  <!-- DOWNLOAD CTA -->
  <section id="download" class="section-clip mx-auto max-w-[1200px] oc-container mt-24 reveal">
    <div class="scroll-fade g-grad grad-anim rounded-3xl overflow-hidden border border-oc-line">
      <div class="p-8 md:p-12 flex flex-col gap-6 md:flex-row md:items-center md:justify-between">
        <div><h2 class="text-2xl md:text-3xl font-semibold text-white">Get OpenCounsel</h2><p class="mt-2 text-white/80 max-w-xl">Your private legal assistant. Always on your desk. Always offline. Always yours.</p></div>
        <div class="flex flex-wrap items-center gap-3">
          <a href="#" class="btn inline-flex items-center gap-2 rounded-xl bg-white text-oc-ink px-4 py-2 font-medium hover:bg-gray-100 focus:ring-2 focus:ring-white/50"><i class="ph ph-apple-logo"></i> Download for macOS</a>
          <a href="#" class="btn inline-flex items-center gap-2 rounded-xl border border-white/30 bg-white/10 text-white px-4 py-2 font-medium hover:bg-white/20 focus:ring-2 focus:ring-white/40"><i class="ph ph-windows-logo"></i> Download for Windows</a>
          <a href="#" class="btn inline-flex items-center gap-2 rounded-xl border border-white/30 bg-white/10 text-white px-4 py-2 font-medium hover:bg-white/20 focus:ring-2 focus:ring-white/40"><i class="ph ph-linux-logo"></i> Linux (AppImage)</a>
        </div>
      </div>
    </div>
  </section>

  <!-- Centered animated logo -->
  <div class="mx-auto my-10 md:my-14 flex items-center justify-center">
    <span class="logo-anim LargeAniLogo" aria-label="OpenCounsel" style="--logo-size: clamp(56px, 30vw, 500px);"></span>
  </div>

  <!-- FOOTER -->
  <footer class="border-t border-oc-line">
    <div class="mx-auto max-w-[1200px] oc-container py-10 flex flex-col items-center gap-6 text-oc-ink/60 text-sm">
      <div class="text-center"><span class="font-semibold text-black">OpenCounsel</span> © <span id="yr"></span> OpenCounsel</div>
      <div class="flex items-center gap-4">
        <a class="hover:text-oc-ink" href="#">Privacy</a>
        <a class="hover:text-oc-ink" href="#">Terms</a>
        <a class="hover:text-oc-ink" href="#download">Download</a>
      </div>
    </div>
  </footer>

  <script>
    // ================================
    // GLOBAL
    // ================================
    window.OC_DEMO_SPEED = typeof window.OC_DEMO_SPEED === 'number' ? window.OC_DEMO_SPEED : 1.25;
    window.OC_DEMO_SOUND = Object.assign({ enabled:true, url:'bass-drop.mp3', volume:0.9 }, window.OC_DEMO_SOUND || {});
    let __OC_AUDIO = null, __WA_CTX = null;

    function measureHeader(){
      const h = document.querySelector('header');
      const px = h ? h.getBoundingClientRect().height : 56;
      document.documentElement.style.setProperty('--hdr', px + 'px');
    }
    document.addEventListener('DOMContentLoaded', measureHeader);
    let __mhTO=null; window.addEventListener('resize', ()=>{ clearTimeout(__mhTO); __mhTO=setTimeout(measureHeader,120); }, {passive:true});

    function getCtx(){ const Ctx = window.AudioContext || window.webkitAudioContext; if(!Ctx) return null; if(!__WA_CTX) __WA_CTX = new Ctx(); return __WA_CTX; }
    function playWithWebAudio(vol=0.9){
      try{
        const ctx = getCtx(); if(!ctx) return;
        const o = ctx.createOscillator(), g = ctx.createGain();
        o.type='sine'; o.frequency.setValueAtTime(100, ctx.currentTime); o.frequency.exponentialRampToValueAtTime(28, ctx.currentTime+0.85);
        g.gain.setValueAtTime(0.0001, ctx.currentTime); g.gain.exponentialRampToValueAtTime(Math.max(0,Math.min(vol,1)), ctx.currentTime+0.02); g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime+1.2);
        o.connect(g).connect(ctx.destination); o.start(); o.stop(ctx.currentTime+1.25); if(ctx.state==='suspended') ctx.resume().catch(()=>{});
      }catch(e){}
    }
    function playBassDrop(){
      if(!window.OC_DEMO_SOUND?.enabled) return;
      const vol = Math.max(0, Math.min(window.OC_DEMO_SOUND.volume ?? 1, 1));
      const url = (window.OC_DEMO_SOUND.url || '').trim();
      if(url){
        if(!__OC_AUDIO){ __OC_AUDIO = new Audio(url); __OC_AUDIO.preload = 'auto'; __OC_AUDIO.addEventListener('error', ()=>playWithWebAudio(vol), {once:true}); }
        try{ __OC_AUDIO.currentTime = 0; __OC_AUDIO.volume = vol; __OC_AUDIO.muted = false; __OC_AUDIO.play().catch(()=>playWithWebAudio(vol)); }catch(e){ playWithWebAudio(vol); }
        return;
      }
      playWithWebAudio(vol);
    }
    function unlockAudio(){ try{ const ctx=getCtx(); if(ctx && ctx.state==='suspended') ctx.resume().catch(()=>{});}catch(e){} try{ if(__OC_AUDIO) __OC_AUDIO.play().catch(()=>{});}catch(e){} }
    ['pointerdown','click','touchstart','keydown'].forEach(evt=>window.addEventListener(evt,unlockAudio,{once:true,passive:true}));

    const yr = document.getElementById('yr'); if (yr) yr.textContent = new Date().getFullYear();

    // Reveal & scroll-fade observers
    const io = new IntersectionObserver((entries)=>{ for (const e of entries){ if(e.isIntersecting){ e.target.classList.add('in'); io.unobserve(e.target);} } }, {threshold:.12});
    document.querySelectorAll('.reveal').forEach(el=>io.observe(el));

    const sbo = new IntersectionObserver((entries)=>{ for(const e of entries){ e.isIntersecting ? e.target.classList.add('in-view') : e.target.classList.remove('in-view'); } }, {threshold:.35, rootMargin:"-12% 0px -12% 0px"});
    document.querySelectorAll('.scroll-fade').forEach(el=>sbo.observe(el));

    // Mobile menu
    const hamburgerBtn = document.getElementById('hamburgerBtn');
    const mobileMenu   = document.getElementById('mobileMenu');
    const closeMenuBtn = document.getElementById('closeMenuBtn');
    function openMenu(){ if (window.matchMedia('(min-width: 768px)').matches) return; mobileMenu.style.display='block'; void mobileMenu.offsetWidth; mobileMenu.classList.add('active'); hamburgerBtn.classList.add('is-active'); hamburgerBtn.setAttribute('aria-expanded','true'); mobileMenu.setAttribute('aria-hidden','false'); document.body.classList.add('overflow-hidden'); }
    function closeMenu(){ mobileMenu.classList.remove('active'); hamburgerBtn.classList.remove('is-active'); hamburgerBtn.setAttribute('aria-expanded','false'); mobileMenu.setAttribute('aria-hidden','true'); document.body.classList.remove('overflow-hidden'); setTimeout(()=>{ if(!mobileMenu.classList.contains('active')) mobileMenu.style.display='none'; }, 550); }
    hamburgerBtn?.addEventListener('click', ()=> mobileMenu.classList.contains('active') ? closeMenu() : openMenu());
    closeMenuBtn?.addEventListener('click', closeMenu);
    mobileMenu?.addEventListener('click', (e)=>{ if (e.target.classList.contains('menu-scrim')) closeMenu(); });
    const mq = window.matchMedia('(min-width: 768px)'); function handleMQ(e){ if (e.matches) closeMenu(); } if(mq.addEventListener) mq.addEventListener('change', handleMQ); else mq.addListener(handleMQ);
    document.addEventListener('keydown', (e)=>{ if (e.key === 'Escape') closeMenu(); });

    window.addEventListener('load', ()=>{ const pageBlur=document.getElementById('pageBlur'); if(!pageBlur) return; pageBlur.classList.add('hide'); setTimeout(()=>pageBlur.remove(),1300); });

    // ================================
    // Chat helpers: autoscroll + streaming
    // ================================
    function sp(ms){ const f = (typeof window.OC_DEMO_SPEED === 'number' && window.OC_DEMO_SPEED > 0) ? window.OC_DEMO_SPEED : 1.0; return ms * f; }
    function rand(a,b){ return Math.floor(Math.random()*(b-a+1))+a; }

    const viewport = document.getElementById('chatViewport');
    function scheduleAutoScroll(){ if (!viewport) return; requestAnimationFrame(()=>{ viewport.scrollTop = viewport.scrollHeight; }); }

    function typewriter(el, text, min=10, max=18){
      return new Promise((resolve)=>{
        let i=0; el.textContent=''; const tn=document.createTextNode(''); el.appendChild(tn);
        (function tick(){ tn.textContent=text.slice(0,i++); if(i%2===0) scheduleAutoScroll(); if(i<=text.length) setTimeout(tick, sp(rand(min,max))); else resolve(); })();
      });
    }

    async function streamHTML(el, html, charMin=10, charMax=18){
      const container=document.createElement('div'); container.innerHTML=html.trim();
      async function walk(src,dst){
        for(const child of Array.from(src.childNodes)){
          if(child.nodeType===Node.TEXT_NODE){
            const text=child.textContent||'';
            await new Promise(res=>{ let i=0; const tn=document.createTextNode(''); dst.appendChild(tn);
              (function tick(){ tn.textContent=text.slice(0,i++); if(i%2===0) scheduleAutoScroll(); if(i<=text.length) setTimeout(tick, sp(rand(charMin,charMax))); else res(); })();
            });
          } else if (child.nodeType===Node.ELEMENT_NODE){
            const clone=child.cloneNode(false); dst.appendChild(clone); scheduleAutoScroll(); await walk(child,clone);
          }
        }
      }
      el.innerHTML=''; await walk(container, el);
    }

    // ================================
    // LIVE CHAT DEMO
    // ================================
    (function chatDemo(){
      const wrap = document.getElementById('chat-demo');
      const list = document.getElementById('demoMessages');
      const tplU = document.getElementById('demoTplUser');
      const tplB = document.getElementById('demoTplBot');

      // ---- Canadian litigation & rights (concise; 4 bubbles) ----
      const msgs = [
        { role:'user', text:"I’m in Canada and a company refused to refund me for a defective product. What are my options to sue?" },
        { role:'assistant', final: `
          <p><strong>Big picture:</strong> Most consumer disputes are civil, not criminal. You can send a <em>demand letter</em> first, then file in <strong>Small Claims Court</strong> (provincial) if needed.</p>
          <ul>
            <li><strong>Charter</strong> rights protect you from government, not private companies.</li>
            <li><strong>Limitation</strong> periods apply (often ~2 years; check your province).</li>
            <li>Keep <strong>evidence</strong>: receipts, emails, photos, refund policy.</li>
          </ul>
          <p><em>Info only, not legal advice.</em></p>
        `},
        { role:'user', text:"Do I need a lawyer and what could it cost me?" },
        { role:'assistant', final: `
          <p><strong>Small Claims:</strong> You can self-represent. Filing fees are modest and limited <em>costs</em> may be awarded. A brief, polite demand letter can trigger settlement.</p>
          <p><strong>Tips:</strong> outline facts, what you want, a deadline, and attach proof. If the amount or issues are complex, consult a lawyer or a legal clinic.</p>
        `},
      ];
      const MAX_BUBBLES = 5;

      function clearList(){ list.innerHTML=''; scheduleAutoScroll(); }
      function lastBubble(){ const rows = list.querySelectorAll('.msg-row'); return rows[rows.length-1] || null; }
      function fitsViewport(){ return viewport.scrollHeight <= viewport.clientHeight; }

      async function appendUser(text){
        const node = tplU.content.cloneNode(true);
        const bubble = node.querySelector('.bubble-user');
        list.appendChild(node); scheduleAutoScroll();
        await typewriter(bubble, text, 14, 18);
      }

      async function appendBotStreaming(finalHTML){
        const node = tplB.content.cloneNode(true);
        const bubble=node.querySelector('.bubble-bot');
        const thinkEl=bubble.querySelector('.ai-think');
        const finalEl=bubble.querySelector('.ai-final');

        list.appendChild(node); scheduleAutoScroll();
        let dots=0; const dotsTimer=setInterval(()=>{ dots=(dots+1)%4; thinkEl.textContent='Thinking'+'.'.repeat(dots); scheduleAutoScroll(); }, sp(300));

        await new Promise((resolve)=>{
          setTimeout(async ()=>{
            clearInterval(dotsTimer);
            thinkEl.classList.add('fade-away'); setTimeout(()=>thinkEl.remove(),380);
            finalEl.classList.remove('hidden'); finalEl.style.opacity=0;
            requestAnimationFrame(()=>{ finalEl.style.transition='opacity .28s ease'; finalEl.style.opacity=1; });
            await streamHTML(finalEl, finalHTML, 9, 16);
            resolve();
          }, sp(620 + Math.random()*520));
        });
      }

      // ===== FIRST MESSAGE IMMEDIATELY (so section never looks empty) =====
      let primed = false;
      document.addEventListener('DOMContentLoaded', ()=>{ primeFirstMessage(); });

      async function primeFirstMessage(){
        if (primed) return;
        primed = true;
        clearList();
        playBassDrop();
        await appendUser(msgs[0].text);
        // If even the first message would overflow (rare), trim its text slightly
        if (!fitsViewport()){
          const bubble = lastBubble()?.querySelector('.bubble');
          if (bubble && bubble.textContent.length > 80){
            bubble.textContent = bubble.textContent.slice(0, 80) + '…';
          }
        }
      }

      // ===== SNAP LOGIC: as soon as user sees first message, +10px scroll snaps demo full-screen =====
      let snapArmed = false;          // armed once the chat is visible
      let snapDone  = false;          // only snap once
      let armScrollY = 0;             // scroll position when armed
      let snapAnimating = false;
      let startedOnce = false;        // chat sequence after snap

      function chatTopTargetY(){
        const hdr = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--hdr')) || 56;
        const rect = wrap.getBoundingClientRect();
        // Align the section top right under the sticky header
        return Math.max(0, window.scrollY + rect.top - hdr);
      }

      function easeOutCubic(t){ return 1 - Math.pow(1 - t, 3); }
      function animateToY(targetY, duration){
        if(snapAnimating) return Promise.resolve();
        return new Promise(resolve=>{
          snapAnimating = true;
          const startY = window.scrollY;
          const dist   = targetY - startY;
          const dur    = Math.max(380, Math.min(duration || 720, 820));
          const t0 = performance.now();

          function step(now){
            if(!snapAnimating){ resolve(); return; }
            const t = Math.min(1, (now - t0) / dur);
            window.scrollTo(0, startY + dist * easeOutCubic(t));
            if (t < 1) requestAnimationFrame(step);
            else { snapAnimating = false; resolve(); }
          }
          requestAnimationFrame(step);
        });
      }
      ['wheel','touchmove','keydown'].forEach(evt=>{
        window.addEventListener(evt, ()=>{ if(snapAnimating) snapAnimating = false; }, {passive:true});
      });

      // Arm the snap when chat section is visible enough (first message seen)
      let lastScrollY = window.scrollY;
      function onScroll(){
        const rect = wrap.getBoundingClientRect();
        const hdr = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--hdr')) || 56;
        const visibleTop = rect.top < window.innerHeight - 40;    // any part on screen
        const aboveHeader = rect.bottom > hdr + 40;

        if (!snapDone && visibleTop && aboveHeader && !snapArmed){
          snapArmed = true;
          armScrollY = window.scrollY;
        }

        // If armed and user has scrolled ~10px further down, trigger snap
        const scrolledDown = window.scrollY > lastScrollY;
        if (!snapDone && snapArmed && scrolledDown && (window.scrollY - armScrollY) > 10){
          primeFirstMessage();
          const target = chatTopTargetY();
          const distance = Math.abs(window.scrollY - target);
          const duration = 420 + Math.min(320, distance * 0.25);
          animateToY(target, duration).then(()=>{
            snapDone = true; snapArmed = false;
            wrap.classList.add('is-snapped'); // add generous top padding
            if (!startedOnce){
              startedOnce = true;
              setTimeout(()=> runFrom(1), 120);
            }
          });
        }

        lastScrollY = window.scrollY;
      }
      window.addEventListener('scroll', onScroll, {passive:true});

      // Continue the conversation from the given index,
      // but stop before it would create vertical scroll in the demo.
      async function runFrom(startIndex){
        let bubbleCount = list.querySelectorAll('.msg-row').length;
        for (let i=startIndex; i<msgs.length && bubbleCount < MAX_BUBBLES; i++){
          const m = msgs[i];
          if (m.role === 'user') await appendUser(m.text);
          else await appendBotStreaming(m.final);

          bubbleCount = list.querySelectorAll('.msg-row').length;

          // If adding this bubble caused overflow, remove it and stop
          if (!fitsViewport()){
            const last = lastBubble();
            if (last) last.remove();
            break;
          }
        }
        scheduleAutoScroll();
        // leave; user can scroll past freely
      }
    })();
  </script>
</body>
</html>
