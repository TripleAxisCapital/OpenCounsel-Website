<!doctype html>
<html lang="en">
<head>
  <!-- ─────────────────────────────────────────────────────────────────────────────
       Minimal, production-ready head
       ───────────────────────────────────────────────────────────────────────────── -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>ONX — What can I help with?</title>
  <meta name="description" content="Ask anything. A fast, clean chat entry with ONX." />
  <meta name="robots" content="index,follow" />
  <meta name="theme-color" content="#ffffff" />

  <!-- Favicons (adjust paths as needed) -->
  <link rel="icon" href="/logo.svg" type="image/svg+xml" sizes="any" />
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" />

  <!-- Inter (system-ui fallback keeps CLS low) -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;600;700&display=swap" rel="stylesheet" />

  <!-- Your custom header component -->
  <script type="module" src="/assets/onx-header.js"></script>

  <!-- ─────────────────────────────────────────────────────────────────────────────
       Base styles: small, robust, Apple-clean
       ───────────────────────────────────────────────────────────────────────────── -->
  <style>
    :root{
      --ink: #0B0B0C;
      --muted: #7A7F86;
      --line: rgba(0,0,0,.10);
      --bg: #ffffff;

      /* Chat field sizing tokens */
      --chat-w: min(880px, 92vw);
      --chat-h: 72px;
      --chat-r: 24px;
      --pad-x: clamp(14px, 2.2vw, 22px);

      /* Header swap threshold (px scrolled before pill header appears) */
      --header-threshold: 8;
    }

    html, body { height: 100%; }
    html { color-scheme: light; }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--ink);
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
      -webkit-font-smoothing: antialiased;
      text-rendering: optimizeLegibility;
    }

    /* Ensure the custom header occupies layout space so main can center correctly */
    onx-header { display: block; }

    /* Main hero area */
    .hero {
      min-height: clamp(520px, 76svh, 880px);
      display: grid;
      grid-template-rows: 1fr auto auto 1fr;
      align-items: center;
      justify-items: center;
      gap: 22px;
      padding: 24px var(--pad-x);
    }

    .title {
      grid-row: 2;
      margin: 0;
      font-weight: 700;
      letter-spacing: -0.01em;
      text-align: center;
      font-size: clamp(28px, 5.2vw, 40px);
    }

    /* Chat container */
    .chat {
      grid-row: 3;
      width: var(--chat-w);
    }
    .chat-form {
      position: relative;
      display: flex;
      align-items: center;
      height: var(--chat-h);
      border: 1px solid var(--line);
      border-radius: var(--chat-r);
      background: #fff;
      box-shadow:
        0 1px 0 rgba(0,0,0,.04),
        0 8px 28px rgba(0,0,0,.06);
      transition: box-shadow .2s ease, border-color .2s ease, transform .12s ease;
    }
    .chat-form:focus-within {
      border-color: rgba(0,0,0,.14);
      box-shadow:
        0 1px 0 rgba(0,0,0,.05),
        0 12px 36px rgba(0,0,0,.10);
      transform: translateY(-1px);
    }

    .chat-input {
      appearance: none;
      border: 0;
      background: transparent;
      width: 100%;
      height: 100%;
      font-size: clamp(16px, 2.6vw, 20px);
      padding: 0 calc(var(--pad-x) + 54px) 0 var(--pad-x);
      color: var(--ink);
      outline: none;
    }
    .chat-input::placeholder { color: #b6bac1; }

    .send {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      height: 46px;
      width: 46px;
      border: 0;
      border-radius: 999px;
      background: #111;
      color: #fff;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: transform .08s ease, box-shadow .18s ease, background .18s ease, opacity .2s ease;
    }
    .send:hover { transform: translateY(-50%) translateY(-1px); box-shadow: 0 8px 20px rgba(0,0,0,.18); }
    .send:active { transform: translateY(-50%) translateY(0); }
    .send[disabled] { opacity: .6; cursor: not-allowed; box-shadow: none; }

    /* Suggestion pills (optional, easy to edit) */
    .pills {
      margin-top: 16px;
      display: grid;
      grid-auto-flow: column;
      gap: 10px;
      align-items: center;
      justify-content: center;
      overflow-x: auto;
      padding-bottom: 4px;
    }
    .pill {
      white-space: nowrap;
      font-size: 14px;
      padding: 10px 14px;
      border-radius: 999px;
      border: 1px solid var(--line);
      color: #111;
      background: #fff;
      box-shadow: 0 2px 10px rgba(0,0,0,.04);
      user-select: none;
    }

    /* Optional brand overlay for maximum compatibility if your header
       doesn't expose a `slot="brand"`. We show it only if JS decides to. */
    #onx-brand-overlay {
      position: absolute;
      inset: 0 auto 0 18px; /* vertically centers via flex on parent wrapper */
      display: none;        /* JS will set to flex only in fallback mode */
      align-items: center;
      font-weight: 700;
      letter-spacing: .01em;
      color: var(--ink);
      pointer-events: none;
    }

    /* Reduced motion: turn off typing animation */
    @media (prefers-reduced-motion: reduce) {
      .send, .chat-form { transition: none !important; }
    }
  </style>

  <!-- ─────────────────────────────────────────────────────────────────────────────
       Brand swap configuration — EDIT JUST THIS if you want different texts
       ───────────────────────────────────────────────────────────────────────────── -->
  <script>
    // One place to edit:
    // The header shows "ONX" when static, and "O" when it becomes a pill/floating header.
    window.ONX_HEADER_LOGO = { static: 'ONX', pill: 'O' };
  </script>
</head>
<body>

  <!--
    Your custom header component. Keep attributes you use in your project.
    threshold="8" is typical for when it flips to a floating/pill style.
    We provide a brand slot <span slot="brand" ...> for components that support it.
    If your component doesn't expose a "brand" slot, our JS falls back to a safe overlay.
  -->
  <onx-header id="siteHeader" threshold="8">
    <!-- Brand content (preferred path if your component supports slot='brand') -->
    <span id="onx-brand-slot" slot="brand" aria-label="ONX brand">ONX</span>

    <!-- Right-side action slot example (optional) -->
    <!-- <a slot="action" href="/download" class="btn">Download</a> -->
  </onx-header>

  <!-- Fallback brand overlay (only shown if slot isn't supported) -->
  <div id="onx-brand-overlay" aria-hidden="true">ONX</div>

  <!-- Main hero -->
  <main class="hero" role="main">
    <h1 class="title">What can I help with?</h1>

    <section class="chat" aria-label="Chat input">
      <form class="chat-form" id="chatForm" action="javascript:;" novalidate>
        <input
          id="chatInput"
          class="chat-input"
          type="text"
          name="q"
          autocomplete="off"
          spellcheck="true"
          placeholder="Explain this code"
          aria-label="Ask ONX anything"
        />
        <button class="send" id="sendBtn" type="submit" aria-label="Send">
          <!-- simple up-arrow icon -->
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M12 4l7 7m0 0l-7 7m7-7H5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </form>

      <!-- Editable suggestion pills (purely presentational) -->
      <div class="pills" aria-hidden="true">
        <span class="pill">Search with ONX</span>
        <span class="pill">Talk with ONX</span>
        <span class="pill">Research</span>
        <span class="pill">Sora</span>
        <span class="pill">More</span>
      </div>
    </section>
  </main>

  <!-- ─────────────────────────────────────────────────────────────────────────────
       Behavior: typing effect + header brand swap (safe with any header impl)
       ───────────────────────────────────────────────────────────────────────────── -->
  <script>
    (function(){
      /* =========================
         1) Typing placeholder loop
         ========================= */
      const prefersReduced = matchMedia('(prefers-reduced-motion: reduce)').matches;
      const input = document.getElementById('chatInput');

      // Feel free to edit or extend
      const prompts = [
        "Explain this code",
        "Summarize this article",
        "Write a friendly follow-up email",
        "Make a quick plan for tomorrow",
        "Find pros & cons for this decision"
      ];

      // If reduced motion, just show the first prompt and stop.
      if (!prefersReduced) {
        let i = 0;
        const typeSpeed = 38;     // ms per char
        const holdMs    = 1100;   // ms holding full text
        const eraseSpeed= 24;

        async function type(text){
          input.setAttribute('placeholder', '');
          for(let k=1;k<=text.length;k++){
            input.setAttribute('placeholder', text.slice(0,k));
            await new Promise(r=>setTimeout(r,typeSpeed));
          }
        }
        async function erase(text){
          for(let k=text.length;k>=0;k--){
            input.setAttribute('placeholder', text.slice(0,k));
            await new Promise(r=>setTimeout(r,eraseSpeed));
          }
        }
        (async function loop(){
          while(document.body){
            const text = prompts[i % prompts.length];
            await type(text);
            await new Promise(r=>setTimeout(r,holdMs));
            await erase(text);
            i++;
          }
        })();
      }

      /* =========================
         2) Chat form submit (stub)
         ========================= */
      const form = document.getElementById('chatForm');
      const sendBtn = document.getElementById('sendBtn');
      form.addEventListener('submit', (e)=>{
        e.preventDefault();
        const v = input.value.trim();
        if(!v) return;
        sendBtn.disabled = true;
        // TODO: hook this to your app. For now we just clear and re-enable.
        setTimeout(()=>{
          input.value = "";
          sendBtn.disabled = false;
          input.focus();
        }, 250);
      });

      /* ==========================================================
         3) Header brand swap (ONE VARIABLE to edit: ONX_HEADER_LOGO)
         - Works whether your <onx-header> supports a brand slot or not
         - If slot not supported, shows a safe overlay brand text
         - Swaps when page scroll passes the threshold (8px default)
         ========================================================== */
      const headerEl = document.getElementById('siteHeader');
      const brandSlotEl = document.getElementById('onx-brand-slot');
      const brandOverlay = document.getElementById('onx-brand-overlay');
      const LOGO = (window.ONX_HEADER_LOGO || {static:'ONX', pill:'O'});

      // 3a) Determine whether the brand slot is actually used by the component.
      // If not, show the overlay label positioned over the header.
      function useOverlayFallbackIfNeeded(){
        // If the slotted element is NOT visible (slot ignored), enable overlay
        const slottedVisible = brandSlotEl && brandSlotEl.offsetParent !== null;
        if (!slottedVisible) {
          // Place overlay over header area
          headerEl.style.position = 'relative';
          brandOverlay.style.display = 'flex';
        }
      }
      // run once after upgrade (if custom element delays rendering)
      customElements.whenDefined('onx-header').then(useOverlayFallbackIfNeeded);
      // …and once on next frame to be safe
      requestAnimationFrame(useOverlayFallbackIfNeeded);

      // 3b) Swap brand on scroll past threshold (mirrors your header's own behavior)
      const THRESH = Number(headerEl.getAttribute('threshold') || 8);
      function updateBrand(){
        const pill = window.scrollY > THRESH;
        const value = pill ? LOGO.pill : LOGO.static;
        if (brandOverlay.style.display === 'flex') {
          brandOverlay.textContent = value;
        } else if (brandSlotEl) {
          brandSlotEl.textContent = value;
        }
        // Optional: update <title> to match state (nice polish)
        // document.title = pill ? `O — What can I help with?` : `ONX — What can I help with?`;
      }
      updateBrand();
      window.addEventListener('scroll', updateBrand, { passive: true });
      window.addEventListener('resize', updateBrand, { passive: true });
    })();
  </script>
</body>
</html>
